{"ast":null,"code":"import{API_CONFIG,HTTP_METHODS,HTTP_STATUS}from'../constants/api';class ApiError extends Error{constructor(message,status){let data=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;super(message);this.name='ApiError';this.status=status;this.data=data;}}export const apiRequest=async function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const{method=HTTP_METHODS.GET,body=null,headers={},timeout=API_CONFIG.TIMEOUT}=options;const url=`${API_CONFIG.BASE_URL}${endpoint}`;const requestOptions={method,headers:{'Content-Type':'application/json',...headers},...(body&&{body:JSON.stringify(body)})};// Add auth token if available\nconst token=localStorage.getItem('accessToken');if(token){requestOptions.headers.Authorization=`Bearer ${token}`;}try{const controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(),timeout);const response=await fetch(url,{...requestOptions,signal:controller.signal});clearTimeout(timeoutId);if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new ApiError(errorData.detail||`HTTP ${response.status}`,response.status,errorData);}// Handle empty responses\nconst contentType=response.headers.get('content-type');if(contentType&&contentType.includes('application/json')){return await response.json();}return null;}catch(error){if(error.name==='AbortError'){throw new ApiError('Request timeout',408);}if(error instanceof ApiError){throw error;}throw new ApiError('Network error',0,error.message);}};export const handleApiError=error=>{if(error instanceof ApiError){switch(error.status){case HTTP_STATUS.UNAUTHORIZED:// Handle unauthorized - redirect to login\nlocalStorage.removeItem('accessToken');localStorage.removeItem('user');window.location.href='/login';break;case HTTP_STATUS.FORBIDDEN:// Handle forbidden\nconsole.error('Access forbidden:',error.message);break;case HTTP_STATUS.NOT_FOUND:// Handle not found\nconsole.error('Resource not found:',error.message);break;default:console.error('API Error:',error.message);}}else{console.error('Unexpected error:',error);}return error.message||'An unexpected error occurred';};export const isNetworkError=error=>{return error.status===0||error.message.includes('Network error');};export const isAuthError=error=>{return error.status===HTTP_STATUS.UNAUTHORIZED||error.status===HTTP_STATUS.FORBIDDEN;};","map":{"version":3,"names":["API_CONFIG","HTTP_METHODS","HTTP_STATUS","ApiError","Error","constructor","message","status","data","arguments","length","undefined","name","apiRequest","endpoint","options","method","GET","body","headers","timeout","TIMEOUT","url","BASE_URL","requestOptions","JSON","stringify","token","localStorage","getItem","Authorization","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","signal","clearTimeout","ok","errorData","json","catch","detail","contentType","get","includes","error","handleApiError","UNAUTHORIZED","removeItem","window","location","href","FORBIDDEN","console","NOT_FOUND","isNetworkError","isAuthError"],"sources":["/Users/macbookpro/Desktop/myWork/personal/AI/first/frontend/src/utils/api.js"],"sourcesContent":["import { API_CONFIG, HTTP_METHODS, HTTP_STATUS } from '../constants/api';\n\nclass ApiError extends Error {\n  constructor(message, status, data = null) {\n    super(message);\n    this.name = 'ApiError';\n    this.status = status;\n    this.data = data;\n  }\n}\n\nexport const apiRequest = async (endpoint, options = {}) => {\n  const {\n    method = HTTP_METHODS.GET,\n    body = null,\n    headers = {},\n    timeout = API_CONFIG.TIMEOUT,\n  } = options;\n\n  const url = `${API_CONFIG.BASE_URL}${endpoint}`;\n  \n  const requestOptions = {\n    method,\n    headers: {\n      'Content-Type': 'application/json',\n      ...headers,\n    },\n    ...(body && { body: JSON.stringify(body) }),\n  };\n\n  // Add auth token if available\n  const token = localStorage.getItem('accessToken');\n  if (token) {\n    requestOptions.headers.Authorization = `Bearer ${token}`;\n  }\n\n  try {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n    const response = await fetch(url, {\n      ...requestOptions,\n      signal: controller.signal,\n    });\n\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new ApiError(\n        errorData.detail || `HTTP ${response.status}`,\n        response.status,\n        errorData\n      );\n    }\n\n    // Handle empty responses\n    const contentType = response.headers.get('content-type');\n    if (contentType && contentType.includes('application/json')) {\n      return await response.json();\n    }\n    \n    return null;\n  } catch (error) {\n    if (error.name === 'AbortError') {\n      throw new ApiError('Request timeout', 408);\n    }\n    if (error instanceof ApiError) {\n      throw error;\n    }\n    throw new ApiError('Network error', 0, error.message);\n  }\n};\n\nexport const handleApiError = (error) => {\n  if (error instanceof ApiError) {\n    switch (error.status) {\n      case HTTP_STATUS.UNAUTHORIZED:\n        // Handle unauthorized - redirect to login\n        localStorage.removeItem('accessToken');\n        localStorage.removeItem('user');\n        window.location.href = '/login';\n        break;\n      case HTTP_STATUS.FORBIDDEN:\n        // Handle forbidden\n        console.error('Access forbidden:', error.message);\n        break;\n      case HTTP_STATUS.NOT_FOUND:\n        // Handle not found\n        console.error('Resource not found:', error.message);\n        break;\n      default:\n        console.error('API Error:', error.message);\n    }\n  } else {\n    console.error('Unexpected error:', error);\n  }\n  \n  return error.message || 'An unexpected error occurred';\n};\n\nexport const isNetworkError = (error) => {\n  return error.status === 0 || error.message.includes('Network error');\n};\n\nexport const isAuthError = (error) => {\n  return error.status === HTTP_STATUS.UNAUTHORIZED || error.status === HTTP_STATUS.FORBIDDEN;\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}